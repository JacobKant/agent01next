# Document Indexer с Vectra и OpenRouter

Система индексации документов для RAG (Retrieval-Augmented Generation) с использованием:
- **Vectra** - локальная векторная база данных
- **OpenRouter API** - для генерации эмбеддингов через модель `qwen/qwen3-embedding-8b`

## Установка

```bash
cd document_indexer
npm install
```

## Настройка

Убедитесь, что в корне проекта (не в папке `document_indexer`) есть файл `.env.local` с ключом:

```
OPENROUTER_API_KEY=sk-or-xxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

## Использование

### Индексация документов

Запустите индексацию документа из папки `data/`:

```bash
npm start
```

Скрипт:
1. Читает документ из `data/vpKnigaOborotnya.txt`
2. Разбивает текст на чанки (1200 символов с перекрытием 200)
3. Генерирует эмбеддинги через OpenRouter API
4. Сохраняет их в локальную базу данных Vectra (папка `vectra_index/`)

### Поиск в RAG

Запустите тестовый поиск:

```bash
npm run search
```

Скрипт:
1. Запрашивает поисковый запрос у пользователя
2. Генерирует эмбеддинг запроса
3. Ищет наиболее релевантные документы в индексе
4. Выводит топ-5 результатов с релевантностью и контекстом

## Структура

- `index.ts` - основной скрипт индексации
- `search.ts` - скрипт для тестового поиска
- `embeddings.ts` - модуль для работы с OpenRouter API
- `vectra_index/` - локальная база данных Vectra (создается автоматически)
- `data/` - папка с документами для индексации
